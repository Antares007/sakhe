// @flow
import type {Stream} from '@most/types'
import type {Absurd, StateRay as InnerStateRay} from './rstate'

export type StateRay<A> = {
  ...$Exact<InnerStateRay<A>>,
  extend<Key: $Keys<A>, B: $Subtype<$ElementType<$Exact<A>, Key>>>(
    key: Key,
    absurdB: Absurd<B>
  ): (pith: Pith<B> | Stream<Pith<B>>) => void
}

export type Pith<A> = (state: StateRay<A>, onChange: Stream<A>) => void

export type Bark<A> = (pith: Pith<A> | Stream<Pith<A>>) => Stream<A>

declare export default function tree<A>(
  absurdA: Absurd<A>,
  initState?: A
): Bark<A>
